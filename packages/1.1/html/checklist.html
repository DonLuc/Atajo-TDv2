<card id="checklist" fill="true" flip="rl">

    <face id="checklistFront" settings="default:true" controller="_checklist.Ctrl">
        <ctl>In-Store Checklist - {{customerName}}</ctl>
        <ctr class="gui-extra" flip-target="checklistHelp">&#xf059;</ctr>

        <content>


            <ul ng-repeat="taskModel in tasks" >

                <li style="width:95%;" ng-repeat="task in taskModel.Tasks.records" id="task-{{task.Id}}" data-task-id="{{task.Id}}" data-is-complete="{{task.completed}}">

                    <div ng-if="task.inputs.length == 0">

                        <table width="100%" style="background: rgba(0,0,0,0.2); border-radius:5px; margin:10px; padding:10px; color:#aaa">
                            <tr   style="background:rgba(0,0,0,0.4); color:white;">
                                <td colspan="1" align="left"  style="padding:5px; border-top-left-radius:5px; ">
                                    <span ng-show="!task.completed && task.mandatory" class="gui-extra">&#61545;</span>
                                    <span ng-show="task.completed" class="gui-extra">&#10003;</span>
                                    <!-- subject -->
                                    {{task.Subject}}
                                </td>
                                <td colspan="2" align="right"  style="padding:5px; border-top-right-radius:5px; ">
                                    Due Date: {{task.ActivityDate}}
                                </td>
                            </tr>
                            <tr>


                                <td style="width:600px;padding-left:30px;">


                                    <cbr maxlength="255"  ng-readonly="task.completed" style="color:black">{{task.Description}}</cbr>


                                </td>

                                <td style="width:350px">
                                    <formElement title="Resolution Comments" >

                                        <textarea maxlength="255" ng-model="task.Resolution_Comments__c" ng-readonly="task.completed"></textarea>

                                    </formElement>
                                </td>
                            </tr>
                            <tr>

                                <td colspan="3" style="background: orange; color: black; padding: 10px; font-size:20pt; border-bottom-left-radius:5px;  border-bottom-right-radius:5px; ">
                                    <center>
                                        <span onTouchStart="_checklist.updateTask(this)" task="{{task.Id}}" ng-disabled="task.completed">Update Task</span>
                                        <span ng-show="task.completed" class="gui-extra">&#10003;</span>
                                        <span ng-show="!task.completed && task.mandatory" class="gui-extra">&#61545;</span>
                                    </center>
                                </td>
                            </tr>
                        </table>
                    </div>



                    <div ng-if="task.inputs.length > 0">

                    <table width="100%" style="background: rgba(0,0,0,0.2); border-radius:5px; margin:10px; padding:10px; color:#aaa">
                        <tr   style="background:rgba(0,0,0,0.4); color:white;">
                            <td colspan="1" align="left"  style="padding:5px; border-top-left-radius:5px; ">
                                <span ng-show="!task.completed && task.mandatory" class="gui-extra">&#61545;</span>
                                <span ng-show="task.completed" class="gui-extra">&#10003;</span>
                                <!-- subject -->
                                {{task.Subject}}
                            </td>
                            <td colspan="2" align="right"  style="padding:5px; border-top-right-radius:5px; ">
                                Due Date: {{task.ActivityDate}}
                            </td>
                        </tr>
                        <tr>
                            <td style="width:600px">

                                <table ng-repeat="input in task.inputs">
                                <tr>

                                  <td>

                                    <formElement title="{{input.name}}">


                                              <select  ng-show="input.isSelect" ng-options="opt as opt.name for opt in input.values" ng-model="input.selected" ng-disabled="task.completed" autocomplete="off">
                                                  <option value="">-- Select --</option>
                                              </select>

                                              <input ng-show="input.textInputs" maxlength="255" ng-model="input.value" ng-readonly="task.completed" />


                                    </formElement>


                                  </td>

                                </tr>


                                </table>
                                <table ng-repeat="input in task.textInputs">
                                    <tr>

                                        <td>

                                            <formElement title="{{input.name}}">


                                                <select  ng-show="input.isSelect" ng-options="opt as opt.name for opt in input.values" ng-model="input.selected" ng-disabled="task.completed" autocomplete="off">
                                                    <option value="">-- Select --</option>
                                                </select>

                                                <input ng-show="input.isTextarea" maxlength="255" ng-model="input.value" ng-readonly="task.completed" />


                                            </formElement>


                                        </td>

                                    </tr>


                                </table>

                            </td>


                            <td style="width:350px">
                                <formElement title="Resolution Comments" >

                                    <textarea maxlength="255" ng-model="task.Resolution_Comments__c" ng-readonly="task.completed"></textarea>

                                </formElement>
                            </td>
                        </tr>
                        <tr>

                            <td colspan="3" style="background: orange; color: black; padding: 10px; font-size:16pt; border-bottom-left-radius:5px;  border-bottom-right-radius:5px; ">
                                <center>
                                    <span onTouchStart="_checklist.updateTask(this)" task="{{task.Id}}" ng-disabled="task.completed">Update Task</span>
                                    <span ng-show="task.completed" class="gui-extra">&#10003;</span>
                                    <span ng-show="!task.completed && task.mandatory" class="gui-extra">&#61545;</span>
                                </center>
                            </td>
                        </tr>
                    </table>
                        </div>



                </li>

            </ul>

            <div style="clear:both;">&nbsp;</div>

        </content>


        <cbl></cbl>
        <cbr>* Resolution Comments are mandatory if this is selected.</cbr>

    </face>


    <face id="checklistHelp" face="back">

        <ctl>HELP</ctl>
        <ctr class="gui" flip-target="close">x</ctr>
        <content>
            <formElement title="Status Indicators">
                <table>
                    <tr>
                        <td>Customer Visits</td>
                        <td>Tasks</td>
                    </tr>
                    <tr>
                        <td><image src="img/icon-blocked-order.png" />  Order Blocked</td>
                        <td><x class='bubbleRed'> 3 </x>  Mandatory</td>
                    </tr>
                    <tr>
                        <td><image src="img/icon-blocked-delivery.png" />  Delivery Blocked</td>
                        <td><x class='bubbleAmber'> 3 </x>  Optional</td>
                    </tr>
                    <tr>
                        <td><image src="img/icon-blocked-deleted.png" /> Customer Deleted</td>
                        <td><x class='gui-extra' style="font-size:13pt; color:green;">&#xf058;</x>  Complete</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><x class='gui-extra' style="font-size:13pt; color:red;">&#61545;</x>  Mandatory Equipment / Task</td>
                    </tr>
                    <tr>
                        <td>Order Items</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><span class="greenLineOrder">&nbsp;</span>  On Promotion</td>
                        <td><image src="img/icon-inventory-new-green.png" />  New Product</td>
                    </tr>
                    <tr>
                        <td><span class="amberLineOrder">&nbsp;</span>  Strategic Package</td>
                        <td><image src="img/icon-inventory-on-hold.png" />  On Hold</td>
                    </tr>
                    <tr>
                        <td><span class="greenLineOrder">&nbsp;</span><span class="amberLineOrder">&nbsp;</span>  Both</td>
                        <td></td>
                    </tr>
                </table>
            </formElement>
        </content>
        <cbl></cbl>
        <cbr></cbr>
    </face>

</card>
